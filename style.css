:root{
  --bg0:#050507;
  --bg1:#07070b;
  --fg:#f2f2f2;

  --pink:#ff3bd4;
  --cyan:#38e8ff;
  --yellow:#ffe45c;
  --petrol:#0bb7b3;
  --purple:#7b5bff;

  --shadow: 0 25px 80px rgba(0,0,0,.70);
  --radius: 18px;

  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  --sans: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;

  /* если захочешь бесшовную картинку-фон: */
  --bg-image: url("img/bg-tile.png"); /* можно оставить как есть или удалить */
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
html{ scroll-behavior:smooth; }

body{
  margin:0;
  color:var(--fg);
  font-family:var(--sans);
  overflow-x:hidden;

  /* ONE WORLD BACKGROUND (фиксированный, бесшовный) */
  background:
    radial-gradient(1200px 700px at 20% -10%, rgba(255,59,212,.10), transparent 55%),
    radial-gradient(900px 600px at 80% 120%, rgba(56,232,255,.08), transparent 60%),
    radial-gradient(700px 500px at 55% 40%, rgba(255,255,255,.05), transparent 55%),
    linear-gradient(180deg, var(--bg1), var(--bg0) 60%, #040406);

  background-attachment: fixed;
}

/* опционально: если есть бесшовная картинка, включи слой */
body.hasTile::before{
  content:"";
  position:fixed;
  inset:0;
  z-index:1;
  pointer-events:none;
  background-image: var(--bg-image);
  background-repeat: repeat;
  background-size: 720px auto;
  opacity:.18;
  mix-blend-mode: screen;
  filter: saturate(1.05) contrast(1.05);
}

/* глобальный grain + scanlines */
body::after{
  content:"";
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:2;
  opacity:.14;
  background-image:
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.35'/%3E%3C/svg%3E");
  mix-blend-mode:soft-light;
  animation: grainMove 7s steps(7) infinite;
}
@keyframes grainMove{
  0%{ transform:translate(0,0); }
  20%{ transform:translate(-2%,1%); }
  40%{ transform:translate(2%,-1%); }
  60%{ transform:translate(-1%,2%); }
  80%{ transform:translate(1%,-2%); }
  100%{ transform:translate(0,0); }
}

/* page above background layers */
.page{
  position:relative;
  z-index:5;
}

/* continuous layout */
.section{
  background: transparent;          /* ВАЖНО: секции не рисуют фон */
  padding: 140px 0 120px;
}
.hero{ padding: 160px 0 90px; }
.stage{ padding: 90px 0 170px; }

.wrap{
  width: min(760px, 94vw);
  margin: 0 auto;
}

/* -------------------------
   SPLASH
------------------------- */
.splash{
  position:fixed;
  inset:0;
  z-index:9999;
  background:#000;
  cursor:pointer;
  display:grid;
  place-items:center;
  overflow:hidden;
}
.splash__img{
  width:100%;
  height:100%;
  object-fit:cover;
  object-position:center;
  opacity:0;
  transform:scale(1.04);
  filter: blur(12px) contrast(1.2);
  animation: splashIn 1.1s ease forwards;
}
@keyframes splashIn{
  to{ opacity:1; transform:scale(1); filter:none; }
}
.splash__noise{
  position:absolute;
  inset:0;
  pointer-events:none;
  opacity:.22;
  mix-blend-mode:overlay;
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(255,255,255,.03) 0px,
      rgba(255,255,255,.03) 1px,
      transparent 2px,
      transparent 6px
    );
}
.splash__hint{
  position:absolute;
  bottom: 28px;
  left:50%;
  transform:translateX(-50%);
  font-family:var(--mono);
  font-size:12px;
  letter-spacing:.18em;
  text-transform:uppercase;
  opacity:.7;
}
.splash.hide{
  animation: splashOut 700ms ease forwards;
}
@keyframes splashOut{
  to{ opacity:0; filter: blur(14px); }
}

/* -------------------------
   Envelope
------------------------- */
.envelope{
  width:100%;
  height: min(380px, 48vw);
  max-height:380px;
  border-radius: 22px;
  border: 1px solid rgba(255,255,255,.12);
  background:
    radial-gradient(900px 420px at 50% 0%, rgba(255,59,212,.10), transparent 60%),
    radial-gradient(700px 420px at 85% 120%, rgba(56,232,255,.08), transparent 55%),
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  box-shadow: var(--shadow);
  position:relative;
  overflow:hidden;
  cursor:pointer;
  padding:0;
  outline:none;
  display:block;
  transform: translateZ(0);
}

.envFront{
  position:absolute;
  inset:0;
  z-index:6;
  display:grid;
  place-items:center;
  gap:10px;
  background:
    radial-gradient(900px 420px at 50% 30%, rgba(123,91,255,.10), transparent 65%),
    rgba(0,0,0,.12);
  transition: opacity 260ms ease;
}
.envFront__title{
  font-family:var(--mono);
  letter-spacing:.14em;
  text-transform:uppercase;
  font-size:14px;
  text-shadow: 0 0 16px rgba(255,59,212,.20);
}
.envFront__sub{
  font-family:var(--mono);
  font-size:12px;
  letter-spacing:.18em;
  text-transform:uppercase;
  opacity:.55;
}

.hero.isFlip .envFront{
  opacity:0;
  pointer-events:none;
}

.envelope__back{
  position:absolute; inset:0;
  background:
    radial-gradient(800px 260px at 20% 40%, rgba(255,255,255,.06), transparent 60%),
    radial-gradient(600px 240px at 80% 70%, rgba(255,255,255,.04), transparent 60%);
}
.envelope__front{
  position:absolute; left:0; right:0; bottom:0;
  height:62%;
  background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.02));
  border-top: 1px solid rgba(255,255,255,.14);
  clip-path: polygon(0 0, 50% 55%, 100% 0, 100% 100%, 0 100%);
}
.envelope__flap{
  position:absolute; left:0; right:0; top:0;
  height:62%;
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.02));
  border-bottom: 1px solid rgba(255,255,255,.14);
  transform-origin: top center;
  transform: rotateX(0deg);
  transition: transform 420ms ease;
  clip-path: polygon(0 0, 100% 0, 50% 70%);
}
.envelope__paper{
  position:absolute;
  left:10%;
  width:80%;
  bottom:10%;
  height:78%;
  border-radius:14px;
  transform: translateY(44%) scale(.98);
  transition: transform 520ms ease;
  box-shadow: 0 16px 40px rgba(0,0,0,.40);
  background:
    radial-gradient(600px 220px at 20% 20%, rgba(255,59,212,.12), transparent 60%),
    radial-gradient(520px 240px at 80% 80%, rgba(56,232,255,.10), transparent 60%),
    rgba(10,10,12,.85);
  border: 1px solid rgba(255,255,255,.14);
}

.hero.isOpen .envelope__flap{ transform: rotateX(165deg); }
.hero.isOpen .envelope__paper{ transform: translateY(-10%) scale(1); }

.letter{
  position:absolute;
  inset:18px;
  z-index:7;
  opacity:0;
  transform: translateY(10px);
  pointer-events:none;
  transition: opacity 260ms ease, transform 260ms ease;
}
.hero.isLetter .letter{
  opacity:1;
  transform: translateY(0);
  pointer-events:auto;
}
.letter__inner{
  height:100%;
  border-radius:18px;
  background:
    radial-gradient(700px 280px at 20% 10%, rgba(255,59,212,.10), transparent 65%),
    radial-gradient(650px 300px at 85% 120%, rgba(56,232,255,.08), transparent 60%),
    rgba(8,8,10,.78);
  border: 1px solid rgba(255,255,255,.14);
  box-shadow: var(--shadow);
  padding:22px;
  display:flex;
  flex-direction:column;
  gap:12px;
  backdrop-filter: blur(8px);
}
.letter__title{
  font-family:var(--mono);
  font-size:14px;
  letter-spacing:.18em;
  text-transform:uppercase;
  opacity:.92;
}
.letter__body{
  flex:1;
  padding:14px;
  border-radius:14px;
  background: rgba(255,255,255,.03);
  border: 1px solid rgba(255,255,255,.12);
  overflow:auto;
  line-height:1.55;
  color: rgba(255,255,255,.92);
}
.pill{
  font-family:var(--mono);
  font-size:11px;
  opacity:.8;
  padding:6px 10px;
  border-radius:999px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.03);
  width: fit-content;
}
.closeLetterBtn{
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.04);
  color: var(--fg);
  border-radius: 14px;
  padding: 10px 14px;
  cursor:pointer;
  font-family:var(--mono);
  letter-spacing:.10em;
  text-transform:uppercase;
  font-size: 12px;
}
.closeLetterBtn:hover{
  border-color: rgba(255,255,255,.35);
  background: rgba(255,255,255,.06);
  box-shadow: 0 0 0 2px rgba(255,59,212,.12);
}

/* -------------------------
   Player
------------------------- */
.playerCard{
  width:100%;
  border-radius: var(--radius);
  border: 1px solid rgba(255,255,255,.14);
  background:
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)),
    radial-gradient(700px 320px at 20% 0%, rgba(255,59,212,.10), transparent 65%),
    radial-gradient(620px 320px at 85% 120%, rgba(56,232,255,.08), transparent 60%);
  box-shadow: var(--shadow);
  padding: 16px;
  position:relative;
  overflow:hidden;
  isolation:isolate;
  backdrop-filter: blur(6px);
}
.playerToggle{
  width:100%;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap: 14px;
  padding: 14px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.03);
  color: var(--fg);
  cursor:pointer;
}
.playerToggle__title{
  font-family: var(--mono);
  letter-spacing:.16em;
  text-transform:uppercase;
  font-size: 13px;
}
.playerToggle__hint{
  font-family: var(--mono);
  letter-spacing:.12em;
  text-transform:uppercase;
  font-size: 11px;
  opacity:.6;
}
.playerBody{
  margin-top:14px;
  display:none;
  flex-direction:column;
  gap:16px;
}
.playerCard.isOpen .playerBody{ display:flex; }

.playerTop{
  display:flex;
  justify-content:space-between;
  gap:16px;
  align-items:flex-start;
}
.brand__title{
  font-family:var(--mono);
  font-size:14px;
  letter-spacing:.18em;
  text-transform:uppercase;
}
.brand__sub{ font-size:12px; opacity:.6; }

.now{ text-align:right; }
.now__title{ font-size:14px; opacity:.95; }
.now__meta{ font-family:var(--mono); font-size:12px; opacity:.65; margin-top:4px; }

.controls{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:12px;
}
.iconBtn, .playBtn{
  border: 1px solid rgba(255,255,255,.16);
  background: rgba(255,255,255,.03);
  color: var(--fg);
  border-radius: 14px;
  padding: 10px 14px;
  cursor:pointer;
  transition: transform 120ms ease, border-color 120ms ease, background 120ms ease, box-shadow 120ms ease;
}
.iconBtn:hover, .playBtn:hover{
  border-color: rgba(255,255,255,.35);
  background: rgba(255,255,255,.06);
  box-shadow: 0 0 0 2px rgba(255,59,212,.12);
}
.iconBtn:active, .playBtn:active{ transform: scale(.98); }
.playBtn{
  min-width: 118px;
  font-weight: 700;
  letter-spacing:.06em;
  text-transform:uppercase;
  font-family:var(--mono);
}

.progress{ width:100%; }
#seek, #vol{
  width:100%;
  appearance:none;
  height:6px;
  border-radius:999px;
  background: rgba(255,255,255,.10);
  border: 1px solid rgba(255,255,255,.10);
  outline:none;
}
#seek::-webkit-slider-thumb{
  appearance:none;
  width:18px; height:18px;
  border-radius:6px;
  background: linear-gradient(135deg, rgba(255,59,212,.95), rgba(56,232,255,.85));
  border: 1px solid rgba(255,255,255,.22);
  box-shadow: 0 10px 20px rgba(0,0,0,.55);
}
#vol::-webkit-slider-thumb{
  appearance:none;
  width:16px; height:16px;
  border-radius:6px;
  background: linear-gradient(135deg, rgba(255,228,92,.95), rgba(11,183,179,.85));
  border: 1px solid rgba(255,255,255,.22);
  box-shadow: 0 10px 20px rgba(0,0,0,.55);
}
.volumeRow{
  display:flex;
  align-items:center;
  gap:10px;
  padding: 0 2px;
}
.volLabel{
  font-family:var(--mono);
  letter-spacing:.12em;
  font-size:12px;
  opacity:.65;
}

.trackList{
  list-style:none;
  padding:0;
  margin:0;
  border-top: 1px solid rgba(255,255,255,.12);
}
.trackItem{
  border-bottom: 1px solid rgba(255,255,255,.10);
  padding: 12px 6px;
  opacity:.78;
}
.trackItem.active{ opacity:1; }
.trackRow{
  display:flex;
  justify-content:space-between;
  gap:10px;
  align-items:center;
}
.tname{ cursor:pointer; font-size:14px; opacity:.92; }
.tdur{ font-family:var(--mono); font-size:12px; opacity:.6; }

.lyricsBtn{
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.03);
  color: var(--fg);
  border-radius: 999px;
  padding: 6px 10px;
  cursor:pointer;
  font-family:var(--mono);
  font-size: 11px;
  letter-spacing:.12em;
  text-transform:uppercase;
}
.lyricsBtn:hover{
  border-color: rgba(255,255,255,.35);
  background: rgba(255,255,255,.06);
}

.lyricsPanel{
  margin-top:10px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.03);
  border-radius: 14px;
  padding: 12px;
  display:none;
}
.trackItem.isLyricsOpen .lyricsPanel{ display:block; }
.lyricsTitle{
  font-family:var(--mono);
  font-size:12px;
  letter-spacing:.14em;
  text-transform:uppercase;
  opacity:.75;
  margin-bottom:10px;
}
.lyricsBody{
  white-space: pre-wrap;
  line-height:1.55;
  font-size:14px;
  color: rgba(255,255,255,.90);
  max-height: 240px;
  overflow:auto;
}

/* -------------------------
   Micro glitch edges
------------------------- */
.microTarget{ position:relative; }
.microTarget.glitchOn::before,
.microTarget.glitchOn::after{
  content:"";
  position:absolute;
  inset:-2px;
  border-radius: inherit;
  pointer-events:none;
  z-index:3;
  opacity:.9;
  mix-blend-mode:screen;
}
.microTarget.glitchOn::before{
  background: linear-gradient(90deg, rgba(255,59,212,.55), transparent 45%);
  transform: translate3d(-6px,0,0);
  filter: blur(.25px);
}
.microTarget.glitchOn::after{
  background: linear-gradient(90deg, rgba(56,232,255,.55), transparent 45%);
  transform: translate3d(6px,0,0);
  filter: blur(.25px);
}
.microTarget.glitchOn{
  animation: glitchPunch 360ms steps(2) 1;
}
@keyframes glitchPunch{
  0%{ filter:none; transform:translate3d(0,0,0); }
  25%{ filter:contrast(1.25) saturate(1.2); transform:translate3d(-2px,1px,0); }
  60%{ filter:contrast(1.18) saturate(1.14) hue-rotate(-10deg); transform:translate3d(2px,-2px,0); }
  100%{ filter:none; transform:translate3d(0,0,0); }
}

/* -------------------------
   Click stars
------------------------- */
#glitchLayer{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:2000;
}
.star{
  position:absolute;
  width:6px;
  height:6px;
  border-radius:999px;
  opacity:0;
  mix-blend-mode:screen;
  filter: blur(.15px);
}
.star.on{ animation: starPop 360ms ease 1; }
@keyframes starPop{
  0%{ opacity:0; transform:scale(.6); }
  20%{ opacity:.95; transform:scale(1.15); }
  70%{ opacity:.55; transform:scale(.95); }
  100%{ opacity:0; transform:scale(.6); }
}

/* responsive */
@media (max-width:420px){
  .playerTop{ flex-direction:column; align-items:flex-start; }
  .now{ text-align:left; }
}
